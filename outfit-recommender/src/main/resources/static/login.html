<!doctype html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <title>로그인</title>
    <link rel="stylesheet" href="/css/styles.css" />
</head>
<body class="container">
<h1>로그인</h1>
<form id="loginForm">
    <label>아이디 <input name="username" required></label>
    <label>비밀번호 <input name="password" type="password" required></label>
    <button>로그인</button>
</form>
<p><a href="/signup.html">회원가입</a></p>

<script type="module">
    import { api, setToken } from "/app.js";

    const form = document.getElementById("loginForm");
    if (form) {
        form.addEventListener("submit", async (e) => {
            e.preventDefault();
            const fd = new FormData(form);
            const body = { username: fd.get("username"), password: fd.get("password") };
            const res = await api("/api/users/login", { method: "POST", body: JSON.stringify(body) });
            const data = await res.json(); // { message, token }
            setToken(data.token);
            location.href = "/index.html";
        });
    }
</script>
</body>
</html>
